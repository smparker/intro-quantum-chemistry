# How to CREST

In this short tutorial, you will be very briefly introduced to the tool CREST, which we
use to search for potentially important conformers and rotamers of molecules.

**IMPORTANT:** Always run CREST calculations on a compute node.

## Definitions

- **conformer**: a conformational isomer of a molecule, meaning the physical
  arrangement of atoms may change, but the bonding topology will not
- **rotamer**: a conformer that can be transformed into the original
  structure if rotations around (nearly) free rotors are performed.
  For example, if two conformers differ only through the rotation of
  a methyl group, then they are probably rotamers.
  
A good way to think about the distinction is that two protons that are
interchanged by a rotamer would likely show up as equivalent in NMR.

## The CREST program

We will use the [CREST program](https://crest-lab.github.io/crest-docs/) for our conformational searches.
CREST stands for Conformerâ€“Rotamer Ensemble Sampling Tool.
Exhaustive searches for viable conformations is computationally incredibly
expensive. For this reason, CREST uses a semiempirical model referred to
as Extended Tight Binding (xtb) to make CREST run much faster than would
be possible using DFT. However, the downside of this is that the structures
produced by CREST should really only be thought of as suggested conformers.
Subsequent optimization and testing using a higher quality method is
required to determine what the actual best conformations would be.

### Quick run

The quickest start you can get with CREST is to run it on the commandline
using an input structure generated by Avogadro. On markov, first load using

    ml smp201_chemx42
    
Then run

    crest molecule.xyz
    
Depending on the size of the molecule, this will take a few minutes or up to an
hour. When it completes, the directory you ran the calculation in will have
a few new files that look like:

    > ls
    -rw-r----- 1 smp201 smp201_chemx42   1772 Aug 28 21:08 coord
    -rw-r----- 1 smp201 smp201_chemx42   1772 Aug 28 21:05 coord.original
    -rw-r----- 1 smp201 smp201_chemx42  10364 Aug 28 21:08 cregen_0.tmp
    -rw-r----- 1 smp201 smp201_chemx42   8899 Aug 28 21:11 cregen_1.tmp
    -rw-r----- 1 smp201 smp201_chemx42    482 Aug 28 21:12 cre_members
    -rw-r----- 1 smp201 smp201_chemx42   1456 Aug 28 21:12 crest_best.xyz
    -rw-r----- 1 smp201 smp201_chemx42  20384 Aug 28 21:12 crest_conformers.xyz
    -rw-r----- 1 smp201 smp201_chemx42    257 Aug 28 21:12 crest.energies
    -rw-r----- 1 smp201 smp201_chemx42 222028 Aug 28 21:12 crest_rotamers.xyz
    -rw-r----- 1 smp201 smp201_chemx42   1106 Aug 25 13:31 molecule.xyz
    -rw-r----- 1 smp201 smp201_chemx42    148 Aug 28 21:05 gfnff_adjacency
    -rw-r----- 1 smp201 smp201_chemx42    330 Aug 28 21:05 gfnff_charges
    -rw-r----- 1 smp201 smp201_chemx42 747680 Aug 28 21:05 gfnff_topo
    drwxr-x--- 2 smp201 smp201_chemx42   4096 Aug 28 21:12 MRMSD
    -rw-r----- 1 smp201 smp201_chemx42   1437 Aug 28 21:05 struc.xyz
    -rw-r----- 1 smp201 smp201_chemx42   1029 Aug 28 21:05 wbo
    
The most important files are `crest.energies`, `crest_best.xyz` and `crest_conformers.xyz`.

- `crest.energies` contains a sorted list of the relative energies (kcal/mol) of all the found conformers
- `crest_best.xyz` is the structure of what CREST found to be the lowest energy structure
- `crest_conformers.xyz` contains the structures of all of the conformers found by CREST,
  in the same order as the relative energies listed in `crest.energies`

Always check the energies found in `crest.energies`. This will give you an idea of
how many potential structures may be thermodynamically important. An example
output is:

    1         0.000
    2         1.376
    3         1.818
    4         1.875
    5         2.370
    6         2.420
    7         2.702
    8         3.456
    9         3.626
    10         3.631
    11         3.634
    12         3.786
    13         4.040
    14         5.190
    
The first conformer always has an energy value of zero because the energies are
all relative. The errors in the energies from methods like XTB are fairly high,
typically on the order of 5-10 kcal/mol. Thus, in principle, for this example,
you would want to use a better method like DFT to test relative energies of
structures within about 2 kcal/mol and maybe even more.

### More detailed tutorial

This is an exceptionally rough guide to using CREST, but there are many many
more options available. The best way to learn how to do more
complicated things with CREST is to read the [online documentation](https://crest-lab.github.io/crest-docs/).

In particular, there is a list of [examples](https://crest-lab.github.io/crest-docs/page/examples)
including [published examples](https://crest-lab.github.io/crest-docs/page/examples/publication).
